(unit-tests 'jpeg)

(defvar *jpeg* #(
0xff 0xd8 0xff 0xe0 0x00 0x10 0x4a 0x46  0x49 0x46 0x00 0x01 0x01 0x00 0x00 0x01
0x00 0x01 0x00 0x00 0xff 0xdb 0x00 0x43  0x00 0x03 0x02 0x02 0x02 0x02 0x02 0x03 
0x02 0x02 0x02 0x03 0x03 0x03 0x03 0x04  0x06 0x04 0x04 0x04 0x04 0x04 0x08 0x06 
0x06 0x05 0x06 0x09 0x08 0x0a 0x0a 0x09  0x08 0x09 0x09 0x0a 0x0c 0x0f 0x0c 0x0a 
0x0b 0x0e 0x0b 0x09 0x09 0x0d 0x11 0x0d  0x0e 0x0f 0x10 0x10 0x11 0x10 0x0a 0x0c 
0x12 0x13 0x12 0x10 0x13 0x0f 0x10 0x10  0x10 0xff 0xdb 0x00 0x43 0x01 0x03 0x03 
0x03 0x04 0x03 0x04 0x08 0x04 0x04 0x08  0x10 0x0b 0x09 0x0b 0x10 0x10 0x10 0x10 
0x10 0x10 0x10 0x10 0x10 0x10 0x10 0x10  0x10 0x10 0x10 0x10 0x10 0x10 0x10 0x10 
0x10 0x10 0x10 0x10 0x10 0x10 0x10 0x10  0x10 0x10 0x10 0x10 0x10 0x10 0x10 0x10 
0x10 0x10 0x10 0x10 0x10 0x10 0x10 0x10  0x10 0x10 0x10 0x10 0x10 0x10 0xff 0xc0 
0x00 0x11 0x08 0x00 0x06 0x00 0x08 0x03  0x01 0x11 0x00 0x02 0x11 0x01 0x03 0x11 
0x01 0xff 0xc4 0x00 0x14 0x00 0x01 0x00  0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 
0x00 0x00 0x00 0x00 0x00 0x00 0x08 0xff  0xc4 0x00 0x20 0x10 0x00 0x02 0x02 0x01 
0x03 0x05 0x00 0x00 0x00 0x00 0x00 0x00  0x00 0x00 0x00 0x00 0x01 0x02 0x03 0x04 
0x05 0x06 0x07 0x11 0x12 0x13 0x22 0x41  0x51 0xff 0xc4 0x00 0x15 0x01 0x01 0x01 
0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00  0x00 0x00 0x00 0x00 0x00 0x00 0x04 0x06 
0xff 0xc4 0x00 0x1e 0x11 0x00 0x03 0x00  0x02 0x02 0x03 0x01 0x00 0x00 0x00 0x00 
0x00 0x00 0x00 0x00 0x00 0x01 0x02 0x03  0x04 0x11 0x05 0x06 0x12 0x21 0x51 0x07 
0xff 0xda 0x00 0x0c 0x03 0x01 0x00 0x02  0x11 0x03 0x11 0x00 0x3f 0x00 0x44 0xed 
0x96 0xcc 0x5f 0xd3 0x0b 0x63 0x29 0x84  0xd5 0xd6 0x22 0x99 0x7b 0xd5 0x6b 0x96 
0x8d 0x1d 0x61 0x72 0xab 0x1c 0xb2 0xf4  0xba 0xb0 0x2c 0xe6 0x24 0x63 0xeb 0xc4 
0x0f 0xbc 0xc9 0x77 0x9f 0xd3 0x7a 0xd3  0xd0 0xf1 0x7d 0x97 0x0a 0x95 0x53 0x5b 
0x33 0x2c 0xc8 0x44 0xa2 0x26 0x45 0x92  0x2a 0xfe 0x2c 0x8c 0x4c 0x80 0x2a 0xa4 
0x68 0xeb 0x5b 0x2d 0xe8 0x29 0x13 0x8a  0xe6 0xf3 0x2b 0x1c 0xcc 0x0c 0x80 0xa1 
0x65 0x30 0x03 0x96 0x6d 0x33 0xca 0x6e  0xe4 0x02 0x08 0x1e 0x44 0xec 0xfd 0x3b 
0xf5 0xf7 0xff 0xd9))

(deftest jpeg-test ()
  "Тест JPEG"
  (print (assert (decode-jpeg *jpeg*)
		 #(#(#(136 102 179) #(111 91 186) #(187 77 104) #(255 183 177) #(60 115 255) #(175 189 174) #(255 239 61) #(247 235 53)) #(#(46 97 238) #(131 109 173) #(50 93 250) #(103 168 144) #(55 149 151) #(194 214 103) #(245 242 85) #(255 236 77)) #(#(42 99 242) #(225 140 33) #(81 106 222) #(25 97 243) #(85 185 95) #(117 176 110) #(143 175 248) #(63 115 251)) #(#(86 138 255) #(239 157 29) #(97 123 208) #(103 169 247) #(115 212 255) #(133 214 243) #(128 212 255) #(92 173 254)) #(#(133 215 255) #(228 159 40) #(155 195 194) #(134 218 252) #(162 228 201) #(165 219 206) #(163 213 212) #(155 224 205)) #(#(145 219 255) #(246 160 37) #(184 227 207) #(255 231 46) #(249 232 54) #(255 234 60) #(247 236 58) #(255 235 67))))))

(run-tests)
